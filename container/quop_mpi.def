BootStrap: docker
From: pawsey/mpich-base:3.1.4_ubuntu18.04

%post
	apt-get update -qq && apt-get -y  --no-install-recommends install \
	build-essential \
	pkg-config \ 
	python3-pip \ 
	python3-dev \
	git \ 
	libfftw3-dev \ 
	libfftw3-mpi-dev

	python3 -m pip install setuptools
	python3 -m pip install wheel numpy scipy mpi4py nlopt pandas

	export CC="mpicc"
	export MPI="ON"
	export HDF5_PKGCONFIG_NAME="hdf5-mpich"
	python3 -m pip -v install --no-cache --no-binary=h5py h5py

	cd ~/
	git clone https://github.com/Edric-Matwiejew/QuOp_MPI
	cd QuOp_MPI
	python3 setup.py sdist bdist_wheel
	cd dist
	python3 -m pip install quop_mpi-1.0.1.tar.gz

%labels
    Edric Matwiejew
    Version v0.0.1
